---
sort: 2
---

# GPEN  
GAN Prior Embedded Network for Blind Face Restoration in the Wild  

## 1. 개요
   - GAN 방식으로 생성한 이미지는 이전 방식과 비교하면 더 좋은 결과를 만들 수 있지만 지나치게 부드럽고 인위적인 문제가 있다. (예를 들면 애니메이션 분위기)
   - 기존 얼굴 이미지 복원 방식으로는 Degradation Model 및 Handcrafted Priors를 기반으로 이 문제를 해결하였다.
   - 금전적인 손실, 시간 낭비, 비즈니스의 이미지 손상, 그리고 부상 이나 사망에 이르기까지 다양하고 심각
   - 최근에는 다양한 연구가 진행되어 많은 진전이 있었지만 실생활에서 발생한 알 수 없고 복잡한 저하로 인한 LQ(Low Quality) 얼굴 이미지의 블라인드 복원(BFR)은 여전히 어려운 연구 과제로 남아있다.  
   - 이러한 문제를 해결하기 위하여 [49], [29, 28, 9], [16], [27] 등 여러 BFR 방법이 제안되었다.  
   - [47]얼굴 디테일을 점진적으로 보충하기 위한 CSR 접근법을 제안하였지만 인위적으로 손상된 얼굴 이미지에는 인상적인 결과를 보이지만 실생활에서 저하된 이미지에 대하여 좋은 결과를 보이지 못했다.  
   - Pix2Pix, CGAN 방식으로 입력 이미지에서 출력이미지로의 HR 직접 매핑을 학습하면 보다 현실적인 결과를 얻지만 지나치게 매끄럽게 만드는 경향이 있다.  
   - GAN이 급속도로 발전하는 가운데 인코더 네트워크를 사용하여 일련의 스타일 벡터를 사전 훈련된 Generator에 공급하기 전에 생성하여 일반적인 Image to Image 변환 프레임워크를 구축하였다. 하지만 이러한 방법은 비시각적 이미지 초고해상도 문제에만 적용될 수 있다.  
   - 사전 훈련된 GAN을 변경하지 핞고 유지하면 복잡한 배경의 실제 LQ 얼굴 이미지를 처리할 때 복원된 얼굴의 화질이 불안정하게 된다.  
   - 제안하는 모델은 일련의 합성 LQ-GQ 얼굴 이미지 쌍에 의해 미세 조정되며 U형태 DNN에 적합하도록 깊게 설계, 깊은 특징은 Global 얼굴 재현을 위한 Code를 생성하는데 사용되고 얕은 특징은 노이즈로 사용되어 Local 얼굴 디테일을 생성하고 이미지 배경을 유지한다. 이러한 방식으로 과도한 부드러움 문제를 피할 수 있다.

## 2. 이전 연구
### 1. Face Image Restoration
   - [50] LQ 이미지에서 얼굴 인식을 처리하기 위하여 Sparse 표현을 사용하여 공동 Blind 이미지 복원 및 인식 방법을 제시하였다.  
   - [13], [24, 40], [48, 31], [25, 30] 등의 이미지 복원 작업을 해결하는 데 있어 DNN의 전례 없는 성공과 함께, 많은 DNN 기반 얼굴 이미지 복원 방법도 제안되었다.  
   - [7, 23, 33] 얼굴 이미지가 특정 구조를 가지고 있다는 점을 감안해 성능 저하 모델을 알지 못한 채 심하게 저하된 이미지에서 선명한 얼굴 이미지를 복원하는지 흥미로운 조사도 진행하였다.  
   - [17] 초 저해상도 얼굴 이미지를 초 고해상도화 할 수 있는 웨이블릿 기반 접근방식을 제시  
   - [7] HR 얼굴을 복원하기 전에 얼굴 형상 학습  
   - [33] 얼굴 이미지 복구와 랜드마크 평가에 대한 두 반복 네트워크 간의 반복적인 협업을 통해 얼굴 초고해상도 작업을 수행  
   - [29] 가이드 이미지와 래퍼 하위 네트워크를 사용하여 LR 입력과 HR 가이드 이미지 간의 외관 변화를 처리, 해당 작업은 제약없는 얼굴 이미지[9], 다중 예시 이미지[28], 다중 스케일 구성요소 사전[27]을 사용하여 더욱 확장시킴  
   - [16] 날카로운 얼굴 구조를 파악하기 위해 3D 안면 이전을 명시적으로 통합
   - [47] 얼굴 디테일을 점진적으로 보충한다.  
   - 기존 모델들은 인위적으로 저하된 얼굴 이미지에는 인상적인 결과를 만들어 냈지만 실제 시나리오에서는 실패하는 경우가 많았다.  
   - 이는 실생활에서 심각하게 저하된 얼굴 이미지에서는 얻기 어려운 정보로 예측할 수 없는 실패로 이어지기 때문  

### 2. Generative Adversarial Network(GAN)  
   - [11]등 다양한 논문으로 GAN 모델을 학습하는데 큰 진전이 있었다.
   - 이미지 인페이팅[48], 초해상도[25, 44], 이미지 컬러화[18, 42], 텍스처 합성[41] 등이 있다.  
   - 조건부 GAN(cGAN)은 서로 다른 조건 정보를 가진 정보를 공급해서[37, 18, 52] 다양한 Image To Image 변환 문제를 성공적으로 처리한다. [18]에서 cGAN이 Image To Image 변환 문제에 대한 범용 해결책으로 사용될 수 있음을 보여준다.  
   - 무감독 학습[52], 분리 학습[26], 소수점 학습[32], 고해상도 이미지 합성[43], 다중 도메인 변환[8], 다중 모드 변환[53]과 같은 많은 후속 작업이 CGAN을 다른 시나리오로 확장하기 위해 제안되었다.
   - cGAN은 입력 도메인에서 출력 도메인으로의 직접적인 매핑을 학습하지만 불행하게도 생성된 결과는 BFR과 같이 매우 적절하지 않은 작업에서 지나치게 부드러워 진다.  

### 3. GAN Prior for Image Generation  
   - 기존 방식은 잠재된 코드[1]을 최적화 하거나 추가 인코더를 학습하여 이미지 공간을 잠재 공간으로 다시 투영한다.[12, 38]  
   - StyleGAN의 확장된 잠복 공간에 이미지를 내장하여 추가 의미 이미지 편집 작업을 수행할 수 있다.  
   - [12] 여러 잠재된 코드를 사용하여 최종 이미지를 출력하기 위한 여러 피쳐 맵을 생성했습니다.  
   - 이러한 방식은 속도가 느리기때문에 PixelToStyleToPixel(pSp)[38] 방식으로 추가적인 최적화 과정없이 실제 이미지를 확장된 잠복 공간에 내장하여 광범위한 Image To Image 변환 작업에 사용할 수 있다.  
   - [34] HR 자연 이미지 다양체를 횡단하여 원본 LR 이미지로 축소할 수 있는 이미지를 검색하는 자체 감독 방식을 제안했습니다.  
   - 이미지 공간을 다시 잠재 공간으로 완벽하게 투영하기는 어렵다.  
   - [46] GAN을 사용한 이미지 생성에 도메인 적응 적용  

## 3. GPEN 네트워크  
### 1. Motivation and Framework  
   - BFR의 기본적인 과정은 LQ x를 매핑함수를 통해 HQ Y로 변환하는 것이다.  
   - 하지만 Y에는 입력 x와 일치할 수 있는 수 많은 이미지가 있다. 이러한 이유로 일대일 매칭이 아닌 일대다 매칭이 된다.  
   - 또한 최종적인 결과는 HQ의 평균이 되는 경향이 있고이는 지나치게 부드러워지는 문제가 발생해 Detail을 잃어버리게 됩니다.[6]  
   - cGAN 방법[18, 43]은 매핑의 불확실성을 줄이기 위하여 적대적 훈련을 통해 이 문제를 부분적으로 희석시킬 수 있다.  
   - 하지만 성능저하가 심각하면 cGAN은 사실적인 텍스처와 Detail을 가진 선명한 얼굴 이미지를 거의 생성하지 못한다. 그림5참고  
   - 이전 방법과 달리 먼저 GAN 이전 네트워크를 학습한 다음 HQ 얼굴 이미지 복원을 위한 디코더로 DNN에 내장한다.  
   - 이러한 네트워크를 GPEN이라고 부른다.  
   - CNN 인코더는 입력 성능 저하 이미지 x를 GAN의 잠재 공간 Z에서 원하는 잠재 코드 z에 매핑하는 방법을 배운다.  
   - Generator를 통해 원하는 HQ얼굴 이미지를 재현할 수 있다.  
   - 기본적으로 일대일 매핑으로 기존 일대다 매핑의 불확실성을 크게 완화한다.  
   - GAN 반전 방법[12,34, 38]은 우리의 GPEN과 유사한 아이디어를 공유하지만 일관되고 편리한 얼굴 조작을 위해 사전 훈련된 GAN을 변경하지 않고 유지하는것에 유의해야 한다.  